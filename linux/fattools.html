<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Eric Brombaugh">
   <meta name="GENERATOR" content="Mozilla/4.72 [en] (X11; U; Linux 2.2.14-5.0 i686) [Netscape]">
   <title>DOS FAT tools for the MPuls3 Ampigo</title>
   <link rel="icon" href="favicon.ico" type="image/x-icon">
   <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"> 
</head>
<body>
<h2>DOS FAT Tools for the MPuls3 Ampigo</h2>

<h3>Introduction</h3>

In early 2002 I bought an <a href=http://www.mpuls3.com/ampigo3.html>MPuls3 Ampigo</a>
MP3 player. this is a cute little device which plays MP3 files stored on Compact Flash
(CF) cards. The CF cards can be written using the included Parallel Port cable and the
Ampigo, or with any other type of CF adapter, such as a PCMCIA or USB adapter.

<p>At the time, I bought a
<a href=http://www.butterflymedia.com/Products-CFReader.asp>ButterFly Media USB adapter</a>
which worked with Win9x, but not Linux. I have patched an existing USB driver to recognize
this device - look <a href=butterfly.html>here</a> for more info. Since then I've also
gotten an inexpensive <a href=http://www.pqiusa.com/our_products.htm>CF PCMCIA adapter</a>
which also works well.

<p>Unfortunately, although Linux can read and write the CF cards, the Ampigo only
recognizes MP3 files which are written by Win9x. The reason is simple - the DOS
FAT filesystem specifies that the EOC (end of cluster) marker is any value of
0xff8-0xfff for FAT12 or 0xfff8-0xffff for FAT16. Linux uses 0xff8 and 0xfff8
respectively, while Win9x uses 0xfff and 0xffff. The Ampigo only recognizes
0xfff and 0xffff!

<p>To get around this, I've written a simple program which scans the FAT of an
unmounted DOS filesystem, correcting the EOC markers where necessary and writing
the results back to the filesystem.

<h3>Compiling and Using</h3>

To begin, grab the code below.

<p>uncompress/untar it, cd to the directory and compile

<p>tar zxf fattools.tar.gz
<br>cd fattools
<br>make

<p>Then, after writing some MP3 files to a CF card, sync and unmount it. When
the unmount process has complete, run 'winfat' on it:

<p>./winfat device

<p> winfat will tell you what it has found and fixed. That's it! Pop the CF card
out and try it out in your Ampigo.

<h3>Download</h3>
Get the code here: <a href=fattools.tar.gz>fattools.tar.gz</a>

<p>Please let me know if these tools for you.


<p><a href="linux.html">Return to Linux page.</a>
<h5>
<b>Last Updated</b></h5>
:2002-02-04
<h5>
<b>Comments to:</b></h5>
<a href="mailto:ebrombaugh1@cox.net">Eric Brombaugh</a>
<br>&nbsp;
</body>
</html>
